import{aq as q,ar as Q,as as W,m as p,C as x,F as J,y as k,Y as O,A as D,r as i,Q as ee,O as B,P as te,at as oe,a6 as _,l as L,d as R,U as N,g as m,au as Y,T as ne,B as K,w as M,ah as X,G as $,x as z,c as ae,a5 as se,p as le,a3 as ce,ag as re,av as ie,am as ue,aw as de,s as ve,al as fe,I as me,ax as ye,a as he}from"./index-f62e9bd4.js";function Ie(e,{args:t=[],done:o,canceled:a}){if(e){const n=e.apply(null,t);q(n)?n.then(l=>{l?o():a&&a()}).catch(Q):n?o():a&&a()}else o()}const j=Symbol();function Ee(e){const t=W(j,null);t&&p(t,o=>{o&&e()})}function F(e){const t=J();t&&x(t.proxy,e)}const Ce={show:Boolean,zIndex:k,overlay:O,duration:k,teleport:[String,Object],lockScroll:O,lazyRender:O,beforeClose:Function,overlayStyle:Object,overlayClass:D,transitionAppear:Boolean,closeOnClickOverlay:O};function Oe(e,t){return e>t?"horizontal":t>e?"vertical":""}function we(){const e=i(0),t=i(0),o=i(0),a=i(0),n=i(0),l=i(0),s=i(""),r=()=>s.value==="vertical",w=()=>s.value==="horizontal",y=()=>{o.value=0,a.value=0,n.value=0,l.value=0,s.value=""};return{move:v=>{const d=v.touches[0];o.value=(d.clientX<0?0:d.clientX)-e.value,a.value=d.clientY-t.value,n.value=Math.abs(o.value),l.value=Math.abs(a.value);const I=10;(!s.value||n.value<I&&l.value<I)&&(s.value=Oe(n.value,l.value))},start:v=>{y(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:y,startX:e,startY:t,deltaX:o,deltaY:a,offsetX:n,offsetY:l,direction:s,isVertical:r,isHorizontal:w}}let P=0;const T="van-overflow-hidden";function Pe(e,t){const o=we(),a="01",n="10",l=u=>{o.move(u);const h=o.deltaY.value>0?n:a,v=oe(u.target,e.value),{scrollHeight:d,offsetHeight:I,scrollTop:b}=v;let C="11";b===0?C=I>=d?"00":"01":b+I>=d&&(C="10"),C!=="11"&&o.isVertical()&&!(parseInt(C,2)&parseInt(h,2))&&_(u,!0)},s=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",l,{passive:!1}),P||document.body.classList.add(T),P++},r=()=>{P&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",l),P--,P||document.body.classList.remove(T))},w=()=>t()&&s(),y=()=>t()&&r();ee(w),B(y),te(y),p(t,u=>{u?s():r()})}function G(e){const t=i(!1);return p(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[be,Se]=L("overlay"),ke={show:Boolean,zIndex:k,duration:k,className:D,lockScroll:O,lazyRender:O,customStyle:Object};var pe=R({name:be,props:ke,setup(e,{slots:t}){const o=i(),a=G(()=>e.show||!e.lazyRender),n=s=>{e.lockScroll&&_(s,!0)},l=a(()=>{var s;const r=x(ne(e.zIndex),e.customStyle);return K(e.duration)&&(r.animationDuration=`${e.duration}s`),M(m("div",{ref:o,style:r,class:[Se(),e.className]},[(s=t.default)==null?void 0:s.call(t)]),[[X,e.show]])});return N("touchmove",n,{target:o}),()=>m(Y,{name:"van-fade",appear:!0},{default:l})}});const xe=$(pe),ge=x({},Ce,{round:Boolean,position:z("center"),closeIcon:z("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:z("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[ze,E]=L("popup");var Ae=R({name:ze,inheritAttrs:!1,props:ge,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:a}){let n,l;const s=i(),r=i(),w=G(()=>e.show||!e.lazyRender),y=ae(()=>{const c={zIndex:s.value};if(K(e.duration)){const f=e.position==="center"?"animationDuration":"transitionDuration";c[f]=`${e.duration}s`}return c}),u=()=>{n||(n=!0,s.value=e.zIndex!==void 0?+e.zIndex:de(),t("open"))},h=()=>{n&&Ie(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},v=c=>{t("clickOverlay",c),e.closeOnClickOverlay&&h()},d=()=>{if(e.overlay)return m(xe,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:v},{default:a["overlay-content"]})},I=c=>{t("clickCloseIcon",c),h()},b=()=>{if(e.closeable)return m(me,{role:"button",tabindex:0,name:e.closeIcon,class:[E("close-icon",e.closeIconPosition),fe],classPrefix:e.iconPrefix,onClick:I},null)},C=()=>t("opened"),H=()=>t("closed"),U=c=>t("keydown",c),V=w(()=>{var c;const{round:f,position:S,safeAreaInsetTop:g,safeAreaInsetBottom:Z}=e;return M(m("div",ve({ref:r,style:y.value,role:"dialog",tabindex:0,class:[E({round:f,[S]:S}),{"van-safe-area-top":g,"van-safe-area-bottom":Z}],onKeydown:U},o),[(c=a.default)==null?void 0:c.call(a),b()]),[[X,e.show]])}),A=()=>{const{position:c,transition:f,transitionAppear:S}=e,g=c==="center"?"van-fade":`van-popup-slide-${c}`;return m(Y,{name:f||g,appear:S,onAfterEnter:C,onAfterLeave:H},{default:V})};return p(()=>e.show,c=>{c&&!n&&(u(),o.tabindex===0&&se(()=>{var f;(f=r.value)==null||f.focus()})),!c&&n&&(n=!1,t("close"))}),F({popupRef:r}),Pe(r,()=>e.show&&e.lockScroll),N("popstate",()=>{e.closeOnPopstate&&(h(),l=!1)}),le(()=>{e.show&&u()}),ce(()=>{l&&(t("update:show",!0),l=!1)}),B(()=>{e.show&&e.teleport&&(h(),l=!0)}),re(j,()=>e.show),()=>e.teleport?m(ie,{to:e.teleport},{default:()=>[d(),A()]}):m(ue,null,[d(),A()])}});const De=$(Ae);function Be(){const e=he({show:!1}),t=n=>{e.show=n},o=n=>{x(e,n,{transitionAppear:!0}),t(!0)},a=()=>t(!1);return F({open:o,close:a,toggle:t}),{open:o,close:a,state:e,toggle:t}}function _e(e){const t=ye(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}export{De as P,we as a,F as b,Ie as c,_e as m,Ee as o,Be as u};
